:root {
  /* Typography */
  /*
    CN-friendly stacks.
    We intentionally do NOT load webfonts here; these are graceful fallbacks.
  */
  --font-body: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans SC",
    "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue",
    Arial, sans-serif;
  --font-display: "Kaiti SC", KaiTi, "STKaiti", "Noto Serif SC",
    "Source Han Serif SC", "Songti SC", SimSun, serif;

  /* Layout */
  --page-max: 1100px;
  --radius-1: 12px;
  --radius-2: 14px;
  --shadow-1: 0 14px 44px rgba(10, 10, 12, 0.12);

  /*
    调色板常量（对齐 Android：xinliu_android/core/designsystem/.../ColorSchemes.kt）
    - 白天：宣纸与墨
    - 黑夜：漆器与流光
  */
  --paper-bg: #f7f8f4; /* 草白 */
  --paper-surface: #fdfbf3; /* 米宣纸 */
  --ink-text: #383431; /* 焦茶 */
  --ink-muted: #878885; /* 雅灰 */

  --qinglu-jade: #1f8a6a; /* 青绿 */
  --qinglu-jade-night: #35c69c; /* 月下青绿 */

  --vermilion: #ff4c39; /* 朱砂 */
  --indigo: #305169; /* 黛蓝 */
  --gold: #f2be45; /* 赤金 */
  --neon-cyan: #00e5bc; /* 荧光青 */

  --night-bg: #18191b; /* 墨灰 */
  --night-surface: #22252a; /* 玄青 */
  --night-text: #e0e0e0; /* 银灰 */
  --night-outline: #6d6e6e;

  /* Light theme (default): paper ink */
  --color-bg: var(--paper-bg);
  --color-surface: var(--paper-surface);
  --color-surface-2: color-mix(in srgb, var(--paper-surface) 88%, var(--ink-text) 12%);
  --color-text: var(--ink-text);
  --color-text-muted: var(--ink-muted);
  --color-border: color-mix(in srgb, var(--ink-text) 18%, transparent);

  --color-primary: var(--qinglu-jade);
  --color-on-primary: #ffffff;
  --color-secondary: var(--indigo);
  --color-on-secondary: #ffffff;

  /* Legacy aliases (used across existing components) */
  --color-accent: var(--color-primary);
  --color-accent-contrast: var(--color-on-primary);
  --color-accent-2: var(--color-secondary);
  --color-accent-gold: var(--gold);

  /* Seal (印章) should always remain vermilion */
  --color-seal: var(--vermilion);
  --color-on-seal: #ffffff;

  --color-danger: #b42318;

  /* Background layers (paper + ink washes) */
  --bg-paper-grain: url("/textures/paper-grain-light.svg");
  --bg-paper-fibers: url("/textures/paper-fibers-light.svg");
  --bg-wash-1: radial-gradient(1100px 560px at 16% -18%, color-mix(in srgb, var(--color-primary) 12%, transparent), transparent 62%);
  --bg-wash-2: radial-gradient(900px 640px at 92% 0%, color-mix(in srgb, var(--color-secondary) 10%, transparent), transparent 64%);
  --bg-wash-3: radial-gradient(900px 700px at 72% 116%, color-mix(in srgb, var(--gold) 10%, transparent), transparent 60%);

  --skeleton-1: color-mix(in srgb, var(--color-text) 10%, transparent);
  --skeleton-2: color-mix(in srgb, var(--color-text) 16%, transparent);
  color-scheme: light;
}

/* Light palette overrides */
html[data-palette="indigo"] {
  --color-primary: var(--indigo);
  --color-on-primary: #ffffff;
  --color-secondary: var(--qinglu-jade);
  --color-on-secondary: #ffffff;
}

html[data-palette="cyber"] {
  --color-primary: var(--neon-cyan);
  --color-on-primary: #0b1f1a;
  --color-secondary: var(--vermilion);
  --color-on-secondary: #ffffff;
}

@media (prefers-color-scheme: dark) {
  :root {
    --color-bg: var(--night-bg);
    --color-surface: var(--night-surface);
    --color-surface-2: color-mix(in srgb, var(--night-surface) 86%, #000000 14%);
    --color-text: var(--night-text);
    --color-text-muted: color-mix(in srgb, var(--night-text) 72%, var(--night-outline));
    --color-border: color-mix(in srgb, var(--night-text) 18%, transparent);
    --color-danger: #ff7875;

    /* Night defaults to Qinglu behavior */
    --color-primary: var(--qinglu-jade-night);
    --color-on-primary: #0b1f1a;
    --color-secondary: var(--gold);
    --color-on-secondary: #1e1300;

    /* Legacy aliases */
    --color-accent: var(--color-primary);
    --color-accent-contrast: var(--color-on-primary);
    --color-accent-2: var(--color-secondary);
    --color-accent-gold: var(--gold);

    --bg-paper-grain: url("/textures/paper-grain-dark.svg");
    --bg-paper-fibers: url("/textures/paper-fibers-dark.svg");
    --bg-wash-1: radial-gradient(1200px 620px at 14% -22%, color-mix(in srgb, var(--color-primary) 10%, transparent), transparent 64%);
    --bg-wash-2: radial-gradient(980px 740px at 94% 4%, color-mix(in srgb, var(--color-secondary) 10%, transparent), transparent 66%);
    --bg-wash-3: radial-gradient(920px 760px at 78% 122%, color-mix(in srgb, var(--gold) 8%, transparent), transparent 62%);

    --skeleton-1: color-mix(in srgb, var(--color-text) 8%, transparent);
    --skeleton-2: color-mix(in srgb, var(--color-text) 14%, transparent);
    color-scheme: dark;
  }

  html[data-palette="indigo"] {
    --color-primary: var(--indigo);
    --color-on-primary: #ffffff;
    --color-secondary: var(--qinglu-jade-night);
    --color-on-secondary: #0b1f1a;
  }

  html[data-palette="cyber"] {
    --color-primary: var(--neon-cyan);
    --color-on-primary: #0b1f1a;
    --color-secondary: var(--gold);
    --color-on-secondary: #1e1300;
  }
}

html[data-theme="light"] {
  --color-bg: var(--paper-bg);
  --color-surface: var(--paper-surface);
  --color-surface-2: color-mix(in srgb, var(--paper-surface) 88%, var(--ink-text) 12%);
  --color-text: var(--ink-text);
  --color-text-muted: var(--ink-muted);
  --color-border: color-mix(in srgb, var(--ink-text) 18%, transparent);

  --color-primary: var(--qinglu-jade);
  --color-on-primary: #ffffff;
  --color-secondary: var(--indigo);
  --color-on-secondary: #ffffff;

  --color-accent: var(--color-primary);
  --color-accent-contrast: var(--color-on-primary);
  --color-accent-2: var(--color-secondary);
  --color-accent-gold: var(--gold);

  --bg-paper-grain: url("/textures/paper-grain-light.svg");
  --bg-paper-fibers: url("/textures/paper-fibers-light.svg");
  --bg-wash-1: radial-gradient(1100px 560px at 16% -18%, color-mix(in srgb, var(--color-primary) 12%, transparent), transparent 62%);
  --bg-wash-2: radial-gradient(900px 640px at 92% 0%, color-mix(in srgb, var(--color-secondary) 10%, transparent), transparent 64%);
  --bg-wash-3: radial-gradient(900px 700px at 72% 116%, color-mix(in srgb, var(--gold) 10%, transparent), transparent 60%);

  --skeleton-1: color-mix(in srgb, var(--color-text) 10%, transparent);
  --skeleton-2: color-mix(in srgb, var(--color-text) 16%, transparent);
  color-scheme: light;
}

html[data-theme="dark"] {
  --color-bg: var(--night-bg);
  --color-surface: var(--night-surface);
  --color-surface-2: color-mix(in srgb, var(--night-surface) 86%, #000000 14%);
  --color-text: var(--night-text);
  --color-text-muted: color-mix(in srgb, var(--night-text) 72%, var(--night-outline));
  --color-border: color-mix(in srgb, var(--night-text) 18%, transparent);
  --color-danger: #ff7875;

  /* Night defaults to Qinglu behavior */
  --color-primary: var(--qinglu-jade-night);
  --color-on-primary: #0b1f1a;
  --color-secondary: var(--gold);
  --color-on-secondary: #1e1300;

  --color-accent: var(--color-primary);
  --color-accent-contrast: var(--color-on-primary);
  --color-accent-2: var(--color-secondary);
  --color-accent-gold: var(--gold);

  --bg-paper-grain: url("/textures/paper-grain-dark.svg");
  --bg-paper-fibers: url("/textures/paper-fibers-dark.svg");
  --bg-wash-1: radial-gradient(1200px 620px at 14% -22%, color-mix(in srgb, var(--color-primary) 10%, transparent), transparent 64%);
  --bg-wash-2: radial-gradient(980px 740px at 94% 4%, color-mix(in srgb, var(--color-secondary) 10%, transparent), transparent 66%);
  --bg-wash-3: radial-gradient(920px 760px at 78% 122%, color-mix(in srgb, var(--gold) 8%, transparent), transparent 62%);

  --skeleton-1: color-mix(in srgb, var(--color-text) 8%, transparent);
  --skeleton-2: color-mix(in srgb, var(--color-text) 14%, transparent);
  color-scheme: dark;
}

html[data-theme="light"][data-palette="indigo"] {
  --color-primary: var(--indigo);
  --color-on-primary: #ffffff;
  --color-secondary: var(--qinglu-jade);
  --color-on-secondary: #ffffff;
}

html[data-theme="light"][data-palette="cyber"] {
  --color-primary: var(--neon-cyan);
  --color-on-primary: #0b1f1a;
  --color-secondary: var(--vermilion);
  --color-on-secondary: #ffffff;
}

html[data-theme="dark"][data-palette="indigo"] {
  --color-primary: var(--indigo);
  --color-on-primary: #ffffff;
  --color-secondary: var(--qinglu-jade-night);
  --color-on-secondary: #0b1f1a;
}

html[data-theme="dark"][data-palette="cyber"] {
  --color-primary: var(--neon-cyan);
  --color-on-primary: #0b1f1a;
  --color-secondary: var(--gold);
  --color-on-secondary: #1e1300;
}

html,
body {
  height: 100%;
  max-width: 100vw;
  overflow-x: hidden;
}

html {
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

body {
  margin: 0;
  color: var(--color-text);
  background-image: var(--bg-paper-grain), var(--bg-paper-fibers), var(--bg-wash-1), var(--bg-wash-2),
    var(--bg-wash-3);
  background-color: var(--color-bg);
  background-repeat: repeat, repeat, no-repeat, no-repeat, no-repeat;
  background-size: 420px 420px, 920px 920px, auto, auto, auto;
  font-family: var(--font-body);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

* {
  box-sizing: border-box;
}

button,
input,
select,
textarea {
  font-family: inherit;
}

a {
  color: inherit;
  text-decoration: none;
}

:focus-visible {
  outline: 2px solid var(--color-accent);
  outline-offset: 2px;
}

::selection {
  background: color-mix(in srgb, var(--color-accent) 22%, transparent);
  color: var(--color-text);
}

/* Subtle themed scrollbars (best-effort; varies by browser). */
* {
  scrollbar-color: color-mix(in srgb, var(--color-border) 85%, var(--color-text-muted)) transparent;
  scrollbar-width: thin;
}

::-webkit-scrollbar {
  width: 12px;
  height: 12px;
}

::-webkit-scrollbar-thumb {
  background: color-mix(in srgb, var(--color-border) 80%, var(--color-text-muted));
  border-radius: 999px;
  border: 3px solid transparent;
  background-clip: content-box;
}

::-webkit-scrollbar-thumb:hover {
  background: color-mix(in srgb, var(--color-border) 70%, var(--color-text));
  border: 3px solid transparent;
  background-clip: content-box;
}

::-webkit-scrollbar-track {
  background: transparent;
}

.srOnly {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

.skeleton {
  border-radius: 999px;
  background: linear-gradient(90deg, var(--skeleton-1), var(--skeleton-2), var(--skeleton-1));
  background-size: 200% 100%;
  animation: skeletonShimmer 1.4s ease-in-out infinite;
}

@keyframes skeletonShimmer {
  0% {
    background-position: 100% 50%;
  }
  100% {
    background-position: 0% 50%;
  }
}
